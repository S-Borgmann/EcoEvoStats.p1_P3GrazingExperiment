"0","## grazing rate generating function ##"
"0","g_gen <- function(rep=3,B_dp=1.3,B_dp_intraC=1.1,B_dm=1.7,B_dm_intraC=1.5,d1=0.2,d2=0.2,dp_intraS=1.2,d3=0.1,dp_interS=0.8,d4=0.1,dm_intraS=1.6,d5=0.1,dm_interS=1.68,d6=0.1,Spec,Alone,IntraC,Comp){"
"0","  B_dp_intraS <- rnorm(3,dp_intraS,d3)"
"0","  B_dp_interS <- rnorm(3,dp_interS,d4)"
"0","  B_dm_intraS <- rnorm(3,dm_intraS,d5)"
"0","  B_dm_interS <- rnorm(3,dm_interS,d6)"
"0","  "
"0","  B3 <- B_dp_intraS*Comp + B_dp_interS*(1-Comp) # B_dp_intraS is the center of the intraspecific grazing rate for D. pulex, and Comp takes a value of 0 for Treatments C,D,E. B_dp_interS is the center of the interspecific grazing rate for D. pulex against D. magna, and Comp takes a value of 1 for treatments F,G,H."
"0","  B4 <- B_dm_intraS*Comp + B_dm_interS*(1-Comp)"
"0","  "
"0","  B_dp_comp <- B_dp_intraC*IntraC + B3*(1-IntraC) # B_dp_intraC is the intra-clonal grazing rate (competition should be most intense when another individual of the same clone is present) and IntraC takes a value of 0 for Treatment B (when the Daphnia is in competition with an individual of the same clone) and a value of 1 for the other treatments."
"0","  B_dm_comp <- B_dm_intraC*IntraC + B4*(1-IntraC) # B_dm_intraC is the intra-clonal grazing rate (competition should be most intense when another individual of the same clone is present) and IntraC takes a value of 0 for Treatment B (when the Daphnia is in competition with an individual of the same clone) and a value of 1 for the other treatments."
"0","  "
"0","  B1 <- B_dp*Alone + B_dp_comp*(1-Alone) # B_dp is the fixed D. pulex grazing rate center, Alone takes a value of 1 for Treatment A (when the Daphnia is in isolation) and 0 for any other treatment (when the Daphnia is in competition)."
"0","  B2 <- B_dm*Alone + B_dm_comp*(1-Alone) # B_dm is the fixed D. magna grazing rate center, Alone takes a value of 1 for Treatment A (when the Daphnia is in isolation) and 0 for any other treatment (when the Daphnia is in competition)."
"0","  "
"0","  g_s <- B1*Spec + B2*(1-Spec) # B1 is the D. pulex grazing rate center, B2 is the D. magna grazing rate center. Spec takes a value of 1 for Dp and 0 for Dm."
"0","  delta_c <- d1*Spec + d2*(1-Spec) # d1 is the Dp among-clone variance, d2 is the Dm among-clone variance."
"0","  "
"0","  g <- rnorm(rep,g_s,delta_c) # rep is the number of replicates per treatment"
"0","  return(g)"
"0","}"
"0",""
"0","# Try this out for Species Dp, Treatment A"
"0","Spec <- 1"
"0","Alone <- 1"
"0","IntraC <- 1"
"0","Comp <- 0"
"0","g_gen(Spec=Spec,Alone=Alone,IntraC=IntraC,Comp=Comp)"
"1","[1]"
"1"," 1.300013"
"1"," 1.524578"
"1"," 1.587971"
"1","
"
"0","# Try this out for Species Dm, Treatment A"
"0","Spec <- 0"
"0","Alone <- 1"
"0","IntraC <- 1"
"0","Comp <- 0"
"0","g_gen(Spec=Spec,Alone=Alone,IntraC=IntraC,Comp=Comp)"
"1","[1]"
"1"," 1.613366"
"1"," 1.839373"
"1"," 1.488726"
"1","
"
"0","g_sim <- function(focal_species,treatment){"
"0","  # Generates a grazing rate value given the treatment of the grazing rate experiment and the species of the focal clone"
"0","  if(focal_species==""Dm""){Spec <- 0}"
"0","  else if (focal_species==""Dp""){Spec <- 1}"
"0","  "
"0","  if(treatment==""A""){"
"0","    Alone <- 1"
"0","    IntraC <- 1"
"0","    Comp <- 0"
"0","  } else if(treatment==""B""){"
"0","    Alone <- 0"
"0","    IntraC <- 0"
"0","    Comp <- 0"
"0","  } else if(treatment == ""C"" | treatment == ""D"" | treatment == ""E""){"
"0","    Alone <- 0"
"0","    IntraC <- 1"
"0","    Comp <- 0"
"0","  } else if(treatment == ""F"" | treatment == ""G"" | treatment == ""H""){"
"0","    Alone <- 0"
"0","    IntraC <- 1"
"0","    Comp <- 1"
"0","  }"
"0","  g_gen(Spec=Spec,Alone=Alone,IntraC=IntraC,Comp=Comp)"
"0","}"
"0",""
"0","g_sim(focal_species=""Dm"",treatment=""B"")"
"1","[1]"
"1"," 1.841409"
"1"," 1.589900"
"1"," 1.690824"
"1","
"
"0","g_sim(focal_species=""Dp"",treatment=""H"")"
"1","[1]"
"1"," 1.228602"
"1"," 1.196639"
"1"," 1.098729"
"1","
"
